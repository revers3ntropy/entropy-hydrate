<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Data Loading</title>
    <script defer type="module">
	    const start = performance.now();

	    import '../index.js';
		await reservoir.init();

		console.log(`Reservoir took ${performance.now() - start}ms to load`);

        const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
		const N = 500;

		function makeText (length) {
			let result  = '';
			for (let i = 0; i < length; i++) {
				result += characters.charAt(Math.floor(Math.random() * characters.length));
			}
			return result;
		}

		const beforeComponent = performance.now();
		reservoir.Component('my-component', ({ text, show }) => `
            <p
                hidden="${!show}"
                style="border-bottom: 1px solid grey; overflow-x: hidden"
            >
                ${text}
            </p>
        `);
		console.log(`Component took ${performance.now() - beforeComponent}ms to define`);

		const data = Array(N).fill(0).map(() => ({
			text: makeText(100),
			show: true
		}));

		const before = performance.now();

		reservoir.set({
			testData: data
		}, true);

		const after = performance.now();
		console.log(`Time to create ${N} elements: ${after - before}ms`);
        console.log(`Total time: ${after - start}ms`);
    </script>
</head>
<body>
<main>
    <p foreach="a in testData">
        <my-component
            $text="a.text"
            $show="a.show"
        ></my-component>
    </p>
</main>
</body>
</html>